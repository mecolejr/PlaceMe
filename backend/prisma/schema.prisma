generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Location {
  id              Int     @id @default(autoincrement())
  name            String
  state           String
  crimeRate       Float?
  hateCrimeIndex  Float?
  diversityIndex  Float?
  policyScore     Float?
  updatedAt       DateTime @default(now()) @updatedAt

  @@unique([name, state], name: "name_state")

  // Relations
  hateCrimes   HateCrime[]
  crimeStats   CrimeStats[]
  demographics Demographics[]
}

model HateCrime {
  id         Int    @id @default(autoincrement())
  locationId Int
  biasType   String
  incidents  Int
  updatedAt  DateTime @default(now()) @updatedAt

  location   Location @relation(fields: [locationId], references: [id])

  @@unique([locationId, biasType])
}

model CrimeStats {
  id           Int    @id @default(autoincrement())
  locationId   Int
  violentRate  Float?
  propertyRate Float?
  updatedAt    DateTime @default(now()) @updatedAt

  location     Location @relation(fields: [locationId], references: [id])

  @@unique([locationId])
}

model Demographics {
  id           Int    @id @default(autoincrement())
  locationId   Int
  diversity    Float?
  // Optional JSON for group shares (e.g., {"group":"share"})
  groupShares  String?
  updatedAt    DateTime @default(now()) @updatedAt

  location     Location @relation(fields: [locationId], references: [id])

  @@unique([locationId])
}

model Meta {
  key       String   @id
  value     String
  updatedAt DateTime @default(now()) @updatedAt
}

